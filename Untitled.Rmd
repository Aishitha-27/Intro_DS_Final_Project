---
title: "Understanding Sales patterns and return dynamics in E-Commerce"
author: Team 3
output: html_document
date: "2024-11-13"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r basic_libraries, include=FALSE}
library(ezids)
library(ggplot2)
library(dplyr)
library(leaflet)
library(tidyverse)
library(outliers)
```


#Glimpse of a dataset
```{r}
data=read.csv("online_sales_dataset.csv")
head(data, 5)
```
## Structure and Summary of Dataset

```{r}
str(data)
```


```{r}
xkablesummary(data, title = "Summary of Dataset")
```
Looking for missing values
```{r}
colSums(is.na(data))
```

```{r}
data_clean<- na.omit(data)
```


```{r}
colSums(is.na(data_clean))
```


```{r}
dim(data_clean)
```

Applying random sample of 10,000 rows for our project
```{r}
set.seed(123) 
data_reduced <- data_clean %>% sample_n(10000)
```

```{r}
nrow(data_reduced)
```

```{r}
dim(data_reduced)
```
```{r}

# Box plot for Quantity
ggplot(data, aes(y = Quantity)) +
  geom_boxplot(fill = "lightblue") +
  ggtitle("Box Plot of Quantity") +
  ylab("Quantity")

# Box plot for Unit Price
ggplot(data, aes(y = UnitPrice)) +
  geom_boxplot(fill = "lightgreen") +
  ggtitle("Box Plot of Unit Price") +
  ylab("Unit Price")

# Box plot for Discount
ggplot(data, aes(y = Discount)) +
  geom_boxplot(fill = "lightcoral") +
  ggtitle("Box Plot of Discount") +
  ylab("Discount")


outliers_quantity <- outlier(data$Quantity)
outliers_unit_price <- outlier(data$UnitPrice)
outliers_discount <- outlier(data$Discount)

print("Outliers in Quantity:")
print(outliers_quantity)

print("Outliers in Unit Price:")
print(outliers_unit_price)

print("Outliers in Discount:")
print(outliers_discount)

remove_outliers <- function(df, column) {
  Q1 <- quantile(df[[column]], 0.25, na.rm = TRUE)
  Q3 <- quantile(df[[column]], 0.75, na.rm = TRUE)
  IQR <- Q3 - Q1
  lower_bound <- Q1 - 1.5 * IQR
  upper_bound <- Q3 + 1.5 * IQR
  df %>% filter(df[[column]] >= lower_bound & df[[column]] <= upper_bound)
}


cleaned_data <- data %>%
  remove_outliers("Quantity") %>%
  remove_outliers("UnitPrice") %>%
  remove_outliers("Discount")


head(cleaned_data)
```

```{r}
head(data_reduced)
```